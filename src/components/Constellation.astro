---
// Seasonal constellation - subtle, night-mode only, integrates with starfield
// Only visible in night mode, with very faint connecting lines on hover

interface Props {
  season?: 'spring' | 'summer' | 'fall' | 'winter' | 'auto';
  size?: number;
}

const { season = 'auto', size = 24 } = Astro.props;

function getCurrentSeason(): 'spring' | 'summer' | 'fall' | 'winter' {
  const month = new Date().getMonth();
  if (month >= 2 && month <= 4) return 'spring';
  if (month >= 5 && month <= 7) return 'summer';
  if (month >= 8 && month <= 10) return 'fall';
  return 'winter';
}

const activeSeason = season === 'auto' ? getCurrentSeason() : season;
---

<span class="constellation" data-season={activeSeason}>
  {activeSeason === 'spring' && (
    <!-- Leo: curved sickle shape -->
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none">
      <path class="line" d="M6 4 L9 7 L7.5 12 L10.5 16 L15 19 L19.5 17.5" />
      <circle class="star star--dim" cx="6" cy="4" r="1" />
      <circle class="star" cx="9" cy="7" r="1.2" />
      <circle class="star star--dim" cx="7.5" cy="12" r="1" />
      <circle class="star" cx="10.5" cy="16" r="1" />
      <circle class="star star--dim" cx="15" cy="19" r="1" />
      <circle class="star" cx="19.5" cy="17.5" r="1.2" />
    </svg>
  )}

  {activeSeason === 'summer' && (
    <!-- Cygnus: cross shape -->
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none">
      <path class="line" d="M12 3 L12 21 M4 13 L20 13" />
      <circle class="star" cx="12" cy="3" r="1" />
      <circle class="star star--bright" cx="12" cy="10" r="1.5" />
      <circle class="star star--dim" cx="12" cy="21" r="1" />
      <circle class="star star--dim" cx="4" cy="13" r="1" />
      <circle class="star star--dim" cx="20" cy="13" r="1" />
    </svg>
  )}

  {activeSeason === 'fall' && (
    <!-- Cassiopeia: W shape -->
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none">
      <path class="line" d="M3 9 L7.5 15 L12 7.5 L16.5 15 L21 9" />
      <circle class="star" cx="3" cy="9" r="1" />
      <circle class="star star--dim" cx="7.5" cy="15" r="1" />
      <circle class="star star--bright" cx="12" cy="7.5" r="1.2" />
      <circle class="star star--dim" cx="16.5" cy="15" r="1" />
      <circle class="star" cx="21" cy="9" r="1" />
    </svg>
  )}

  {activeSeason === 'winter' && (
    <!-- Orion: belt + shoulders -->
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none">
      <path class="line" d="M6 4.5 L8.25 11.25 L4.5 19.5 M18 4.5 L15.75 11.25 L19.5 19.5 M8.25 11.25 L15.75 11.25" />
      <circle class="star" cx="6" cy="4.5" r="1" />
      <circle class="star" cx="18" cy="4.5" r="1" />
      <circle class="star star--bright" cx="8.25" cy="11.25" r="1.2" />
      <circle class="star star--bright" cx="12" cy="11.25" r="1.2" />
      <circle class="star star--bright" cx="15.75" cy="11.25" r="1.2" />
      <circle class="star star--dim" cx="4.5" cy="19.5" r="1" />
      <circle class="star star--dim" cx="19.5" cy="19.5" r="1" />
    </svg>
  )}
</span>

<style>
  .constellation {
    display: inline-flex;
    align-items: center;
    margin-left: 6px;
    opacity: 0;
    transition: opacity 0.6s ease;
    pointer-events: none;
  }

  /* Only show in night mode */
  [data-theme="night"] .constellation {
    opacity: 1;
  }

  /* Stars - soft glowing points */
  .star {
    fill: #f8f6f2;
    filter: blur(0.3px);
    animation: twinkle 3s ease-in-out infinite;
  }

  .star--bright {
    fill: #d4a574;
    filter: blur(0.2px) drop-shadow(0 0 2px #d4a574);
  }

  .star--dim {
    opacity: 0.5;
    animation-delay: 1.5s;
  }

  /* Lines - very faint, only visible on hover */
  .line {
    stroke: #d4a574;
    stroke-width: 0.4;
    fill: none;
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  /* Show lines when hovering over nav brand */
  :global(.nav__brand:hover) .line {
    opacity: 0.3;
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.9; }
  }

  .star--bright {
    animation-name: twinkle-bright;
  }

  @keyframes twinkle-bright {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }
</style>
